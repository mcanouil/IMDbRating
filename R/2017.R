library(tibble)
library(readr)
library(lubridate)
library(here)

movies_db <- tribble(
  ~date_time, ~room, ~theatre, ~imdb_id,
  "2017-01-02 16:00", 11, "LILLE", "tt3470600",
  "2017-01-04 18:55", 6, "MAJESTIC", "tt3416532",
  "2017-01-05 19:50", 9, "LILLE", "tt4550098",
  "2017-01-16 17:55", 1, "LILLE", "tt2034800",
  "2017-01-22 13:50", 11, "LILLE", "tt2361317",
  "2017-01-25 19:30", 1, "LILLE", "tt3783958",
  "2017-01-27 18:10", 8, "LILLE", "tt5157682",
  "2017-02-04 15:25", 6, "LILLE", "tt5736696",
  "2017-02-13 13:30", 5, "LILLE", "tt4466894",
  "2017-02-16 14:00", 4, "LILLE", "tt5657028",
  "2017-02-16 20:20", 9, "LILLE", "tt4731136",
  "2017-02-17 18:00", 5, "LILLE", "tt4116284",
  "2017-02-21 19:40", 1, "LILLE", "tt5351818",
  "2017-02-25 19:40", 2, "LILLE", "tt3262342",
  "2017-02-26 19:45", 1, "LILLE", "tt4972582",
  "2017-03-03 20:15", 9, "LILLE", "tt6063866",
  "2017-03-04 10:50", 1, "LILLE", "tt3315342",
  "2017-03-04 19:50", 4, "LILLE", "tt2763304",
  "2017-03-07 19:50", 5, "LILLE", "tt4385888",
  "2017-03-08 19:40", 1, "LILLE", "tt3731562",
  "2017-03-09 19:30", 11, "LILLE", "tt4846340",
  "2017-03-16 20:15", 8, "LILLE", "tt5834036",
  "2017-03-18 19:10", 9, "LILLE", "tt1212428",
  "2017-03-22 19:30", 6, "LILLE", "tt2771200",
  "2017-03-26 20:15", 5, "LILLE", "tt6445396",
  "2017-03-28 19:25", 4, "MAJESTIC", "tt4954522",
  "2017-03-29 18:10", 3, "LILLE", "tt5976178",
  "2017-03-31 20:15", 1, "LILLE", "tt1219827",
  "2017-04-01 13:50", 6, "LILLE", "tt3874544",
  "2017-04-02 17:00", 4, "LILLE", "tt3741834",
  "2017-04-08 13:50", 11, "LILLE", "tt2398241",
  "2017-04-08 16:25", 2, "VDA", "tt3717490",
  "2017-04-09 13:50", 1, "LILLE", "tt5804948",
  "2017-04-09 20:00", 14, "LILLE", "tt5975354",
  "2017-04-12 18:15", 10, "LILLE", "tt4693612",
  "2017-04-13 20:15", 2, "LILLE", "tt4291600",
  "2017-04-18 10:50", 9, "LILLE", "tt4630562",
  "2017-04-18 20:00", 8, "LILLE", "tt5442430",
  "2017-04-19 19:20", 12, "LILLE", "tt1800302",
  "2017-04-20 20:00", 1, "LILLE", "tt5544384",
  "2017-04-23 13:45", 6, "LILLE", "tt5969846",
  "2017-04-28 17:45", 9, "LILLE", "tt6009140",
  "2017-04-29 10:50", 1, "LILLE", "tt3896198",
  "2017-05-05 20:15", 8, "LILLE", "tt2568862",
  "2017-05-06 13:35", 1, "LILLE", "tt5052448",
  "2017-05-10 19:25", 6, "LILLE", "tt2316204",
  "2017-05-13 20:15", 13, "LILLE", "tt4645330",
  "2017-05-16 19:45", 6, "LILLE", "tt1972591",
  "2017-05-20 13:15", 11, "LILLE", "tt5687040",
  "2017-05-25 14:00", 1, "LILLE", "tt1790809",
  "2017-06-04 13:40", 12, "LILLE", "tt1734493",
  "2017-06-04 17:50", 9, "LILLE", "tt6081632",
  "2017-06-05 13:45", 3, "MAJESTIC", "tt3289956",
  "2017-06-08 19:10", 1, "LILLE", "tt0451279",
  "2017-06-16 20:15", 1, "LILLE", "tt2345759",
  "2017-06-18 13:40", 2, "MAJESTIC", "tt4158096",
  "2017-06-23 19:30", 9, "LILLE", "tt1469304",
  "2017-06-24 16:00", 4, "LILLE", "tt6947294",
  "2017-06-28 21:30", 6, "LILLE", "tt3371366",
  "2017-07-08 10:50", 10, "LILLE", "tt4977530",
  "2017-07-08 15:55", 4, "LILLE", "tt6286630",
  "2017-07-08 17:45", 11, "LILLE", "tt6645154",
  "2017-07-09 16:05", 4, "MAJESTIC", "tt4547056",
  "2017-07-11 20:05", 6, "LILLE", "tt3469046",
  "2017-07-13 19:15", 6, "LILLE", "tt2250912",
  "2017-07-14 10:30", 5, "LILLE", "tt5770430",
  "2017-07-14 15:50", 11, "LILLE", "tt5731132",
  "2017-07-15 13:30", 7, "LILLE", "tt5247704",
  "2017-07-16 15:45", 11, "LILLE", "tt6314690",
  "2017-07-19 20:05", 4, "LILLE", "tt4287320",
  "2017-07-20 19:45", 8, "LILLE", "tt3890160",
  "2017-07-21 20:15", 10, "LILLE", "tt7023354",
  "2017-07-21 22:05", 3, "LILLE", "tt6021860",
  "2017-07-22 13:40", 1, "LILLE", "tt5013056",
  "2017-07-25 20:00", 11, "LILLE", "tt3606752",
  "2017-07-25 21:55", 1, "LILLE", "tt2239822",
  "2017-07-29 13:30", 10, "LILLE", "tt4411596",
  "2017-07-29 17:55", 12, "LILLE", "tt2331100",
  "2017-08-03 16:20", 1, "LILLE", "tt3450958",
  "2017-08-03 21:00", 3, "MAJESTIC", "tt5037626",
  "2017-08-05 20:50", 4, "MAJESTIC", "tt2062700",
  "2017-08-11 18:00", 6, "LILLE", "tt1648190",
  "2017-08-13 11:00", 5, "LILLE", "tt5715410",
  "2017-08-13 20:00", 8, "LILLE", "tt2406566",
  "2017-08-24 18:10", 9, "LILLE", "tt5592248",
  "2017-08-25 19:45", 9, "LILLE", "tt1959563",
  "2017-08-25 22:00", 12, "LILLE", "tt4629266",
  "2017-08-29 19:50", 9, "LILLE", "tt1536537",
  "2017-09-05 15:30", 7, "LILLE", "tt6452332",
  "2017-09-06 13:25", 4, "LILLE", "tt5362988",
  "2017-09-06 15:55", 6, "LILLE", "tt5629340",
  "2017-09-06 17:40", 2, "LILLE", "tt5972780",
  "2017-09-07 16:30", 12, "LILLE", "tt4769824",
  "2017-09-16 13:15", 1, "LILLE", "tt3532216",
  "2017-09-17 15:30", 4, "MAJESTIC", "tt4846232",
  "2017-09-23 20:15", 6, "LILLE", "tt6293032",
  "2017-09-25 20:15", 9, "LILLE", "tt6096500",
  "2017-09-26 20:00", 12, "LILLE", "tt6481478",
  "2017-09-30 13:50", 12, "LILLE", "tt6194538",
  "2017-09-30 19:30", 5, "LILLE", "tt5109784",
  "2017-10-01 14:05", 6, "LILLE", "tt6423776",
  "2017-10-04 20:20", 1, "LILLE", "tt1856101",
  "2017-10-05 20:30", 6, "LILLE", "tt5699154",
  "2017-10-06 18:05", 2, "LILLE", "tt6330052",
  "2017-10-18 19:05", 6, "LILLE", "tt4649466",
  "2017-10-19 18:05", 4, "LILLE", "tt6144762",
  "2017-10-20 19:00", 12, "LILLE", "tt4995790",
  "2017-10-22 13:15", 8, "LILLE", "tt6515342",
  "2017-10-23 20:00", 9, "LILLE", "tt6021478",
  "2017-10-25 19:05", 7, "LILLE", "tt5390504",
  "2017-10-26 18:00", 2, "MAJESTIC", "tt5258850",
  "2017-10-28 14:00", 1, "LILLE", "tt3501632",
  "2017-10-29 13:40", 4, "MAJESTIC", "tt5313906",
  "2017-11-01 13:45", 5, "LILLE", "tt5598160",
  "2017-11-04 13:35", 4, "LILLE", "tt6183834",
  "2017-11-05 13:40", 11, "LILLE", "tt3486626",
  "2017-11-05 16:45", 13, "LILLE", "tt5715874",
  "2017-11-12 18:05", 11, "LILLE", "tt5742374",
  "2017-11-15 18:45", 4, "MAJESTIC", "tt5208216",
  "2017-11-17 19:45", 1, "LILLE", "tt0974015",
  "2017-11-22 17:50", 8, "LILLE", "tt6470762",
  "2017-11-25 15:30", 12, "LILLE", "tt6304046",
  "2017-11-26 15:45", 9, "LILLE", "tt2380307",
  "2017-11-28 20:00", 6, "LILLE", "tt7018010",
  "2017-12-02 16:45", 3, "LILLE", "tt1758810",
  "2017-12-03 16:30", 11, "LILLE", "tt4468740",
  "2017-12-10 15:40", 11, "LILLE", "tt0491175",
  "2017-12-12 20:05", 7, "LILLE", "tt7219324",
  "2017-12-13 18:45", 1, "MAJESTIC", "tt3402236",
  "2017-12-17 15:35", 3, "LILLE", "tt3411444",
  "2017-12-18 17:50", 5, "LILLE", "tt6515420",
  "2017-12-20 19:30", 10, "LILLE", "tt2543472",
  "2017-12-21 19:15", 9, "LILLE", "tt2283362",
  "2017-12-23 10:45", 1, "LILLE", "tt2527336",
  "2017-12-31 15:30", 3, "LILLE", "tt6286668",
  "2017-12-23 17:50", 13, "LILLE", "tt7217028",
  "2017-12-24 13:50", 4, "MAJESTIC", "tt5649144",
  "2017-12-29 16:35", 10, "LILLE", "tt5061360",
  "2017-12-29 19:10", 11, "LILLE", "tt5294550",
  "2017-12-31 13:30", 2, "LILLE", "tt6350304",
  "2017-12-31 20:05", 9, "LILLE", "tt2380307"
)

write_csv(
  x = movies_db,
  path = here("data", unique(gsub("([0-9]{4})-.*", "\\1.csv", movies_db$date_time)))
)
